import{j as e,f as S,l as U,n as V,d as M,c as T,i as O,k as $,r as j,h as H}from"./index-DJmfIAfU.js";function Q({label:t,value:a,onChange:r,options:s,disabled:o=!1,required:u=!1,helpText:c,error:n}){const p=l=>{r(l.target.value)},d=!!n;return e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:[t,u&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx("select",{value:a,onChange:p,disabled:o,required:u,className:`w-full px-3 py-2 bg-surface border rounded-lg focus:outline-none focus:ring-2 disabled:opacity-50 disabled:cursor-not-allowed ${d?"border-red-500 focus:ring-red-500":"border-surface-elevated focus:ring-primary"}`,"aria-invalid":d,"aria-describedby":d?`${t}-error`:void 0,children:s.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))}),d&&e.jsx("p",{id:`${t}-error`,className:"mt-1 text-sm text-red-400",role:"alert",children:n}),c&&!d&&e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:c})]})}function z({label:t,value:a,onChange:r,disabled:s=!1,helpText:o,error:u}){const c=()=>{s||r(!a)},n=!!u;return e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:a,onChange:c,disabled:s,className:"sr-only","aria-invalid":n}),e.jsx("div",{className:`block w-14 h-8 rounded-full transition-colors ${a?"bg-primary":"bg-surface-elevated"} ${s?"opacity-50 cursor-not-allowed":""} ${n?"ring-2 ring-red-500":""}`}),e.jsx("div",{className:`absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition-transform ${a?"transform translate-x-6":""}`})]}),e.jsxs("div",{className:"ml-3",children:[e.jsx("span",{className:"text-sm font-medium",children:t}),n&&e.jsx("p",{className:"text-sm text-red-400",role:"alert",children:u}),o&&!n&&e.jsx("p",{className:"text-sm text-gray-400",children:o})]})]})})}function W({label:t,value:a,onChange:r,min:s,max:o,step:u=1,unit:c="",disabled:n=!1,required:p=!1,helpText:d,error:l,showValue:w=!0,scale:h="linear"}){const m=i=>{if(h==="linear")return i;if(i===0)return s;const g=s===0?1:s,b=Math.log(g),_=Math.log(o),C=Math.log(i);return g+(C-b)/(_-b)*(o-g)},v=i=>{if(h==="linear")return i;if(i===s)return 0;const g=s===0?1:s,b=Math.log(g),_=Math.log(o),C=(i-g)/(o-g),D=b+C*(_-b);return Math.round(Math.exp(D))},f=i=>{const g=Number(i.target.value),b=v(g);r(b)},y=!!l,k=m(a),E=(k-s)/(o-s)*100,F=h==="logarithmic"?v(s+(o-s)/2):(s+o)/2,N=i=>i===0&&s===0?"0":Number.isInteger(i)?i.toString():i.toFixed(u>=1?0:u.toString().split(".")[1]?.length||1);return e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("label",{className:"block text-sm font-medium",children:[t,p&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),w&&e.jsxs("span",{className:"text-sm font-mono text-gray-400",children:[a,c]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"range",value:k,onChange:f,min:s,max:o,step:h==="logarithmic"?1:u,disabled:n,className:`w-full h-2 rounded-lg appearance-none cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed
            ${y?"slider-error":"slider-default"}`,style:{background:`linear-gradient(to right,
              rgb(59, 130, 246) 0%,
              rgb(59, 130, 246) ${E}%,
              rgb(55, 65, 81) ${E}%,
              rgb(55, 65, 81) 100%)`},"aria-invalid":y,"aria-describedby":y?`${t}-error`:void 0}),e.jsx("div",{className:"relative w-full h-4 mt-1",children:[0,25,50,75,100].map(i=>{const g=i===0||i===50||i===100;return e.jsx("div",{className:"absolute",style:{left:`${i}%`,transform:"translateX(-50%)"},children:e.jsx("div",{className:`w-px bg-gray-500 mx-auto ${g?"h-3":"h-2"}`})},i)})}),e.jsx("div",{className:"relative w-full",children:e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 px-1",children:[e.jsxs("span",{children:[N(s),c]}),e.jsxs("span",{children:[N(F),c]}),e.jsxs("span",{children:[N(o),c]})]})})]}),y&&e.jsx("p",{id:`${t}-error`,className:"mt-1 text-sm text-red-400",role:"alert",children:l}),d&&!y&&e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:d}),e.jsx("style",{children:`
        input[type='range']::-webkit-slider-thumb {
          appearance: none;
          width: 16px;
          height: 16px;
          border-radius: 50%;
          background: rgb(59, 130, 246);
          cursor: pointer;
          border: 2px solid rgb(30, 41, 59);
        }

        input[type='range']::-webkit-slider-thumb:hover {
          background: rgb(96, 165, 250);
        }

        input[type='range']::-moz-range-thumb {
          width: 16px;
          height: 16px;
          border-radius: 50%;
          background: rgb(59, 130, 246);
          cursor: pointer;
          border: 2px solid rgb(30, 41, 59);
        }

        input[type='range']::-moz-range-thumb:hover {
          background: rgb(96, 165, 250);
        }

        input[type='range'].slider-error::-webkit-slider-thumb {
          background: rgb(239, 68, 68);
        }

        input[type='range'].slider-error::-moz-range-thumb {
          background: rgb(239, 68, 68);
        }
      `})]})}const P={list:async t=>(await M(`/0/api/profiles?camera_id=${t}`)).profiles||[],get:async t=>{const a=await M(`/0/api/profiles/${t}`);return{profile_id:a.profile_id,camera_id:a.camera_id,name:a.name,description:a.description,is_default:a.is_default,created_at:a.created_at,updated_at:a.updated_at,param_count:Object.keys(a.params).length,params:a.params}},create:async t=>(await S("/0/api/profiles",t)).profile_id,update:async(t,a)=>{await V(`/0/api/profiles/${t}`,a)},delete:async t=>{await U(`/0/api/profiles/${t}`)},apply:async t=>(await S(`/0/api/profiles/${t}/apply`,{})).requires_restart||[],setDefault:async t=>{await S(`/0/api/profiles/${t}/default`,{})}},x={all:["profiles"],lists:()=>[...x.all,"list"],list:t=>[...x.lists(),t],details:()=>[...x.all,"detail"],detail:t=>[...x.details(),t]};function R(t){return T({queryKey:x.list(t),queryFn:()=>P.list(t),staleTime:1e3*60*5})}function q(){const t=O();return $({mutationFn:a=>P.create(a),onSuccess:(a,r)=>{t.invalidateQueries({queryKey:x.list(r.camera_id)})}})}function K(){const t=O();return $({mutationFn:a=>P.apply(a),onSuccess:()=>{t.invalidateQueries({queryKey:["config"]})}})}function L({cameraId:t,onClose:a}){const[r,s]=j.useState(""),[o,u]=j.useState(""),{mutate:c,isPending:n}=q(),p=()=>{r.trim()&&c({name:r.trim(),description:o.trim()||void 0,camera_id:t,snapshot_current:!0},{onSuccess:()=>{a()},onError:l=>{console.error("Failed to save profile:",l)}})},d=l=>{l.key==="Enter"&&!l.shiftKey?(l.preventDefault(),p()):l.key==="Escape"&&a()};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-surface-base border border-gray-700 rounded-lg shadow-xl max-w-md w-full mx-4 p-6",onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Save Configuration Preset"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white transition-colors","aria-label":"Close dialog",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"profile-name",className:"block text-sm font-medium text-gray-400 mb-1",children:["Preset Name ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{id:"profile-name",type:"text",value:r,onChange:l=>s(l.target.value),onKeyDown:d,placeholder:"e.g., Daytime, Nighttime",className:"w-full px-3 py-2 bg-surface-elevated border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-primary",autoFocus:!0,maxLength:50})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"profile-description",className:"block text-sm font-medium text-gray-400 mb-1",children:"Description (optional)"}),e.jsx("textarea",{id:"profile-description",value:o,onChange:l=>u(l.target.value),placeholder:"Brief description of this preset",className:"w-full px-3 py-2 bg-surface-elevated border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-primary resize-none",rows:2,maxLength:200})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"This will save your current camera settings including brightness, motion detection, and framerate."})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:a,disabled:n,className:"flex-1 px-4 py-2 bg-surface-elevated border border-gray-600 text-white rounded-lg hover:bg-surface-hover transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{onClick:p,disabled:!r.trim()||n,className:"flex-1 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-hover transition-colors disabled:bg-primary/30 disabled:cursor-not-allowed",children:n?"Saving...":"Save"})]})]})})}function X({cameraId:t,readOnly:a=!1}){const{data:r,isLoading:s,error:o}=R(t),{mutate:u,isPending:c}=K(),{addToast:n}=H(),[p,d]=j.useState(null),[l,w]=j.useState(!1),h=()=>{if(p){const v=r?.find(f=>f.profile_id===p)?.name||"profile";u(p,{onSuccess:f=>{f.length>0?n(`Profile "${v}" applied. Restart required for: ${f.join(", ")}`,"warning"):n(`Profile "${v}" applied successfully`,"success"),d(null)},onError:f=>{n(`Failed to apply profile: ${f instanceof Error?f.message:"Unknown error"}`,"error")}})}};return o?e.jsx("div",{className:"mb-4 pb-4 border-b border-surface-elevated",children:e.jsxs("div",{className:"bg-danger/10 border border-danger rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-danger font-medium",children:"Failed to load profiles"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:o instanceof Error?o.message:"Unable to connect to profiles API"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 pb-4 border-b border-surface-elevated",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Configuration Preset"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsxs("select",{disabled:s||!r||r.length===0,value:p??"",onChange:m=>d(Number(m.target.value)||null),className:"w-full px-3 py-2 bg-surface-elevated border border-gray-600 rounded-lg text-white disabled:text-gray-500 disabled:cursor-not-allowed appearance-none focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:s?"Loading...":!r||r.length===0?"No presets available":"Select a preset"}),r?.map(m=>e.jsxs("option",{value:m.profile_id,children:[m.is_default?"⭐ ":"",m.name,m.description?` - ${m.description}`:""]},m.profile_id))]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!a&&e.jsx("button",{type:"button",onClick:()=>w(!0),className:"px-4 py-2 bg-surface-elevated border border-gray-600 text-white rounded-lg hover:bg-surface-hover transition-colors",title:"Save current settings as a new preset",children:"Save"}),e.jsx("button",{type:"button",onClick:h,disabled:!p||c,className:"px-4 py-2 bg-primary text-white rounded-lg disabled:bg-primary/30 disabled:text-gray-500 disabled:cursor-not-allowed hover:bg-primary-hover transition-colors",title:"Apply selected preset to camera",children:c?"Applying...":"Apply"})]}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Quick switch camera settings • ",r?.length||0," preset",r?.length!==1?"s":""]})]}),l&&e.jsx(L,{cameraId:t,onClose:()=>w(!1)})]})}function Y(t){const[a,r]=t.split("x").map(Number);return{width:a||0,height:r||0}}function J(t,a){return`${t}x${a}`}function Z(t,a,r){return Math.round(t/100*a*r)}function ee(t,a,r){const s=a*r;return s===0?0:Number((t/s*100).toFixed(2))}const A={disabled:"","camera-name":"%$",timestamp:"%Y-%m-%d\\n%T"};function te(t){for(const[a,r]of Object.entries(A))if(r===t)return a;return"custom"}function ae(t,a){return t==="custom"&&a!==void 0?a:A[t]||""}const I={"motion-triggered":{picture_output:"on"},"motion-triggered-one":{picture_output:"first"},best:{picture_output:"best"},center:{picture_output:"center"},"interval-snapshots":{picture_output:"off",snapshot_interval:60},manual:{picture_output:"off",snapshot_interval:0},off:{picture_output:"off",snapshot_interval:0}};function re(t,a){if(a>0)return"interval-snapshots";switch(t){case"on":return"motion-triggered";case"first":return"motion-triggered-one";case"best":return"best";case"center":return"center";case"off":return"manual";default:return"manual"}}function se(t){return I[t]||{picture_output:"off",snapshot_interval:0}}const B={"motion-triggered":{movie_output:!0,movie_output_motion:!0,emulate_motion:!1},continuous:{movie_output:!0,movie_output_motion:!1,emulate_motion:!0},off:{movie_output:!1,emulate_motion:!1}};function le(t,a,r=!1){return t?r?"continuous":"motion-triggered":"off"}function oe(t){return B[t]||{movie_output:!1,emulate_motion:!1}}function ie(t){return T({queryKey:["cameraCapabilities",t],queryFn:async()=>{const a=await M("/0/status.json"),r=`cam${t}`,s=a.status[r];return s&&typeof s=="object"?s.supportedControls||{}:{}},staleTime:6e4,retry:1,enabled:t>0})}const ne=[{width:320,height:240,label:"320x240 (QVGA)"},{width:640,height:480,label:"640x480 (VGA)"},{width:800,height:600,label:"800x600 (SVGA)"},{width:1024,height:768,label:"1024x768 (XGA)"},{width:1280,height:720,label:"1280x720 (HD)"},{width:1920,height:1080,label:"1920x1080 (Full HD)"},{width:2560,height:1440,label:"2560x1440 (QHD)"},{width:3840,height:2160,label:"3840x2160 (4K)"}],ce=[{value:0,label:"0°"},{value:90,label:"90°"},{value:180,label:"180°"},{value:270,label:"270°"}],ue=[{value:0,label:"Auto"},{value:1,label:"Incandescent"},{value:2,label:"Tungsten"},{value:3,label:"Fluorescent"},{value:4,label:"Indoor"},{value:5,label:"Daylight"},{value:6,label:"Cloudy"},{value:7,label:"Custom"}],de=[{value:0,label:"Manual"},{value:1,label:"Auto"},{value:2,label:"Continuous"}],pe=[{value:0,label:"Normal"},{value:1,label:"Macro"},{value:2,label:"Full"}],me=[{value:0,label:"Normal"},{value:1,label:"Fast"}],ge=[{value:"mkv",label:"MKV (Matroska)",group:"basic"},{value:"mp4",label:"MP4",group:"basic"},{value:"mov",label:"MOV (QuickTime)",group:"basic"},{value:"3gp",label:"3GP (Mobile)",group:"basic"},{value:"mkv:h264_v4l2m2m",label:"MKV - H.264 Hardware",group:"hardware"},{value:"mp4:h264_v4l2m2m",label:"MP4 - H.264 Hardware",group:"hardware"},{value:"mkv:libx264",label:"MKV - H.264 Software",group:"software"},{value:"mp4:libx264",label:"MP4 - H.264 Software",group:"software"},{value:"mkv:libx265",label:"MKV - H.265 Software (high CPU)",group:"hevc"},{value:"hevc",label:"HEVC/H.265 in MP4 (high CPU)",group:"hevc"},{value:"webm",label:"WebM (VP8)",group:"webm"}];function fe(t){return t.includes("v4l2m2m")}function be(t){return t.includes("libx265")||t==="hevc"}const he=[{value:"ultrafast",label:"Ultrafast",description:"Lowest CPU (~35-40%), lowest quality"},{value:"superfast",label:"Superfast",description:"Very low CPU"},{value:"veryfast",label:"Very Fast",description:"Low CPU"},{value:"faster",label:"Faster",description:"Below average CPU"},{value:"fast",label:"Fast",description:"Slightly below average CPU"},{value:"medium",label:"Medium (Default)",description:"Balanced CPU/quality (~50-60%)"},{value:"slow",label:"Slow",description:"Above average quality"},{value:"slower",label:"Slower",description:"High quality"},{value:"veryslow",label:"Very Slow",description:"Highest quality (~70-80%), highest CPU"}],xe=[{value:0,label:"None"},{value:1,label:"Basic"},{value:2,label:"Digest"}],ve=[{value:"off",label:"Off"},{value:"on",label:"On"},{value:"preview",label:"Preview"},{value:"both",label:"Both"}];export{de as A,X as C,he as E,W as F,ve as L,ge as M,ne as R,Z as a,z as b,Q as c,ce as d,Y as e,J as f,ue as g,pe as h,me as i,ae as j,xe as k,re as l,te as m,se as n,le as o,ee as p,fe as q,be as r,oe as s,ie as u};
